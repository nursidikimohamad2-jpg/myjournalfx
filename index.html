<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>RR Journal — Presentasi</title>
  <style>
    :root{--bg:#0b1220;--panel:#0f172a;--text:#e2e8f0;--muted:#94a3b8;--ring:rgba(255,255,255,.08);--pos:#10b981;--neg:#f43f5e}
    *{box-sizing:border-box}
    body{margin:0;background:#07111f;color:var(--text);font:14px/1.5 system-ui,Inter,Segoe UI,Roboto}
    .wrap{max-width:1180px;margin:0 auto;padding:28px}
    h1{font-size:28px;margin:0 0 4px}
    .muted{color:var(--muted)}
    .cards{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;margin:16px 0 22px}
    .card{background:rgba(15,23,42,.88);border:1px solid var(--ring);border-radius:12px;padding:14px;min-height:72px;display:flex;flex-direction:column;gap:6px}
    .k{font-size:12px;color:var(--muted)} .v{font-size:18px;font-weight:700}
    .pos{color:var(--pos)} .neg{color:var(--neg)}
    .block{background:rgba(15,23,42,.88);border:1px solid var(--ring);border-radius:14px;padding:16px;margin:14px 0}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .thumb{background:#0b1628;border:1px solid var(--ring);height:260px;border-radius:12px;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .thumb>img{max-width:100%;max-height:100%;object-fit:contain}
    .cap{font-size:12px;color:var(--muted);margin-top:6px}
    .badge{display:inline-flex;align-items:center;gap:6px;padding:.2rem .55rem;border-radius:999px;border:1px solid var(--ring);font-size:12px}
    .LONG{background:#032a3a;color:#aaf;border-color:#0ea5e9}
    .SHORT{background:#3a1a1a;color:#ffd6d6;border-color:#f97316}
    .TP1,.TP2,.TP3{background:rgba(16,185,129,.1);color:#a7f3d0;border-color:#10b981}
    .SL{background:rgba(244,63,94,.1);color:#fecaca;border-color:#f43f5e}
    table.meta{width:100%;border-collapse:separate;border-spacing:0 8px}
    table.meta td{padding:8px 10px;border-radius:8px;background:#0c172a;border:1px solid var(--ring)}
    table.meta td.k{width:25%;color:#9fb1c5}
    table.meta td.v{text-align:right;font-weight:600}
    .eval{background:#0c172a;border:1px solid var(--ring);border-radius:8px;padding:10px 12px;min-height:120px}
    .head{display:flex;align-items:center;gap:8px;margin-bottom:12px}
    .sym{font-size:18px;font-weight:700}
    .time{font-size:12px;color:var(--muted)}
    .flex{display:flex;gap:16px}
    .grow{flex:1}
    .sep{height:1px;background:var(--ring);margin:10px 0}

    /* header sticky */
    .report-header{
      position: sticky; top:0; z-index:50;
      background: rgba(15,23,42,.96);
      backdrop-filter: blur(6px);
      border-bottom: 1px solid var(--ring);
      box-shadow: 0 6px 20px rgba(0,0,0,.25);
    }
    .report-main{ padding-top:12px }

    /* FAB up/down */
    #fabScroll{
      position:fixed; right:16px; bottom:16px; display:none;
      width:44px; height:44px; border-radius:9999px;
      background:#0b1628; color:#e5f0ff; border:1px solid var(--ring);
      box-shadow:0 8px 24px rgba(0,0,0,.35);
      cursor:pointer; outline:0; display:flex; align-items:center; justify-content:center;
    }
    #fabScroll:hover{ filter:brightness(1.12) }
    #fabScroll:active{ transform:translateY(1px) }
    #fabScroll svg{ width:18px; height:18px }

    /* Lightbox export + zoom & pan */
    #lb{position:fixed; inset:0; background:rgba(0,0,0,.8); display:none; align-items:center; justify-content:center; z-index:100}
    #lb.open{display:flex}
    #lb .close{position:absolute; top:14px; right:14px; background:#111827; color:#fff; border:1px solid var(--ring); padding:6px 10px; border-radius:10px; cursor:pointer}

    #lbInner{
      position:relative; overflow:hidden;
      max-width:92vw; max-height:90vh;
      border-radius:12px; border:1px solid var(--ring);
      background:#000; box-shadow:0 20px 60px rgba(0,0,0,.55);
      display:flex; align-items:center; justify-content:center;
    }
    #lbImg{
      display:block; max-width:none; max-height:none;
      user-select:none; -webkit-user-drag:none;
      transform-origin:center center; cursor:zoom-in;
    }

    @media (max-width:900px){ .row{grid-template-columns:1fr} .cards{grid-template-columns:repeat(2,1fr)} }
    @media print{ body{background:#fff;color:#000} .wrap{max-width:100%;padding:0 16px} .card,.block,.thumb,.eval{background:#fff;border-color:#ddd} #fabScroll{display:none !important} }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- HEADER -->
    <div class="report-header">
      <div>
        <h1>Nama Project</h1>
        <div class="muted">Rentang: 2025-01-01 — 2025-10-12 • Disusun otomatis dari RR Journal</div>
      </div>
      <div class="cards">
        <div class="card"><div class="k">Transaksi</div><div class="v">12</div></div>
        <div class="card"><div class="k">Win / Loss</div><div class="v">8 / 4</div></div>
        <div class="card"><div class="k">Total R (Net)</div><div class="v pos">+12.0</div></div>
        <div class="card"><div class="k">1R (USD)</div><div class="v">$25.00</div></div>
        <div class="card"><div class="k">P/L (USD)</div><div class="v pos">+$300.00</div></div>
      </div>
    </div>

    <div class="report-main">

      <!-- 1× KARTU TRADE (contoh) -->
      <div class="block">
        <div class="head">
          <div class="sym">XAUUSD</div>
          <span class="badge LONG">LONG</span>
          <span class="badge TP2">TP2</span>
          <div class="time">• 2025-10-10 09:21</div>
        </div>

        <div class="row">
          <div>
            <div class="thumb">
              <!-- Ganti src base64/URL kamu; class="zoomable" WAJIB -->
              <img class="zoomable" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nNjAwJyBoZWlnaHQ9JzI2MCcgdmlld0JveD0nMCAwIDYwMCAyNjAnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc+PHBhdGggZD0nTTIwLDkwIEwxNDAsMTMwIEwyODAsNjAgTDQyMCwxNzAgTDU4MCwxMTAnIGZpbGw9J25vbmUnIHN0cm9rZT0nI0I2RUZGRicgc3Ryb2tlLXdpZHRoPSczJyBzdHJva2UtbGluZWNhcD0ncm91bmQnLz48L3N2Zz4=" alt="Sebelum">
            </div>
            <div class="cap">Sebelum — (placeholder/chart atau gambar sebelum)</div>
          </div>
          <div>
            <div class="thumb">
              <img class="zoomable" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nNjAwJyBoZWlnaHQ9JzI2MCcgdmlld0JveD0nMCAwIDYwMCAyNjAnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc+PHBhdGggZD0nTTIwLDE0MCBMMjEwLDE1MCBMMzYwLDE2MCBMNTgwLDExMCcgaWQ9J3BhdGgnIGZpbGw9J25vbmUnIHN0cm9rZT0nI0I2RUZGRicgc3Ryb2tlLXdpZHRoPSczJyBzdHJva2UtbGluZWNhcD0ncm91bmQnLz48L3N2Zz4=" alt="Sesudah">
            </div>
            <div class="cap">Sesudah — (placeholder/chart atau gambar sesudah)</div>
          </div>
        </div>

        <div class="flex" style="margin-top:12px">
          <div class="grow">
            <table class="meta">
              <tr>
                <td class="k">Entry</td><td class="v">2350.00</td>
                <td class="k">TP1 (harga)</td><td class="v">2355.00</td>
                <td class="k">R1</td><td class="v pos">+1</td>
              </tr>
              <tr>
                <td class="k">Stop Loss</td><td class="v">2345.00</td>
                <td class="k">TP2 (harga)</td><td class="v">2360.00</td>
                <td class="k">R2</td><td class="v pos">+2</td>
              </tr>
              <tr>
                <td class="k">Δ (Entry–SL)</td><td class="v">5.00</td>
                <td class="k">TP3 (harga)</td><td class="v">2365.00</td>
                <td class="k">R3</td><td class="v">0</td>
              </tr>
              <tr>
                <td class="k">R (Net)</td><td class="v pos">+2</td>
                <td class="k">Equity (sim)</td><td class="v">$1,300.00</td>
                <td class="k">P/L (sim)</td><td class="v pos">+$50.00</td>
              </tr>
            </table>
          </div>
          <div class="eval grow">
            <div class="k" style="margin-bottom:6px">Evaluasi</div>
            <div>Contoh catatan trade…</div>
          </div>
        </div>
      </div>

      <!-- Tambah kartu lainnya di sini (dinamis dari data kamu) -->

    </div><!-- /report-main -->

    <div class="muted" style="text-align:right;margin-top:10px">Dibuat: 12/10/2025 10:00</div>

    <!-- FAB up/down -->
    <button id="fabScroll" aria-label="Scroll" title="Scroll">
      <svg id="fabIcon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 19V5M5 12l7-7 7 7"/>
      </svg>
    </button>
  </div>

  <!-- ===== Lightbox export (zoom + pan) ===== -->
  <div id="lb" aria-modal="true" role="dialog">
    <button class="close" aria-label="Tutup">Tutup</button>
    <div id="lbInner">
      <img id="lbImg" alt="">
    </div>
  </div>

  <script>
    // FAB up/down
    (function(){
      var btn  = document.getElementById('fabScroll');
      var icon = document.getElementById('fabIcon');
      function setIcon(dir){
        icon.innerHTML = (dir==='down')
          ? '<path d="M12 5v14M19 12l-7 7-7-7"/>'
          : '<path d="M12 19V5M5 12l7-7 7 7"/>';
        btn.title = (dir==='down') ? 'Ke bagian bawah' : 'Kembali ke atas';
      }
      function update(){
        var need = document.body.scrollHeight > innerHeight + 8;
        if(!need){ btn.style.display='none'; return; }
        btn.style.display='flex';
        if(scrollY < 100){
          setIcon('down');
          btn.onclick = function(){ scrollTo({top:document.body.scrollHeight, behavior:'smooth'}); };
        }else{
          setIcon('up');
          btn.onclick = function(){ scrollTo({top:0, behavior:'smooth'}); };
        }
      }
      addEventListener('scroll',update,{passive:true});
      addEventListener('resize',update);
      document.addEventListener('DOMContentLoaded',update);
      update();
    })();
  </script>

  <script>
    // Lightbox + Zoom & Pan
    (function(){
      var lb = document.getElementById('lb');
      var img = document.getElementById('lbImg');
      var inner = document.getElementById('lbInner');
      var btnClose = lb.querySelector('.close');

      // ========= ZOOM (fit-first) =========
      var baseScale = 1;      // agar awalnya fit ke frame
      var scale = 1;          // faktor zoom (1..MAX_Z)
      var MIN_Z = 1, MAX_Z = 5, STEP = 0.2;

      // ========= PAN (geser) =========
      var tx = 0, ty = 0;     // posisi geser
      var startX=0, startY=0, startTx=0, startTy=0;
      var dragging = false;

      img.style.willChange = 'transform';
      img.style.transformOrigin = 'center center';

      function applyTransform(){
        img.style.transform = 'translate(' + tx + 'px,' + ty + 'px) scale(' + (baseScale * scale) + ')';
        img.style.cursor = dragging ? 'grabbing' : (scale > 1 ? 'grab' : 'zoom-in');
      }
      function resetZoomPan(){
        scale = 1; tx = 0; ty = 0; applyTransform();
      }

      function computeBaseScale(){
        var cw = inner.clientWidth, ch = inner.clientHeight;
        var nw = img.naturalWidth || img.width;
        var nh = img.naturalHeight || img.height;
        if(!nw || !nh || !cw || !ch){ baseScale = 1; return; }
        baseScale = Math.min(cw/nw, ch/nh);
        img.style.width  = nw + 'px';   // kunci ke natural; transform yg atur tampilan
        img.style.height = 'auto';
      }

      function clampPan(){
        var cw = inner.clientWidth, ch = inner.clientHeight;
        var nw = img.naturalWidth || img.width;
        var nh = img.naturalHeight || img.height;
        var sw = nw * baseScale * scale;
        var sh = nh * baseScale * scale;
        var maxX = Math.max(0, (sw - cw)/2);
        var maxY = Math.max(0, (sh - ch)/2);
        if (tx >  maxX) tx =  maxX;
        if (tx < -maxX) tx = -maxX;
        if (ty >  maxY) ty =  maxY;
        if (ty < -maxY) ty = -maxY;
      }

      function openFromEl(el){
        img.onload = function(){
          computeBaseScale();
          resetZoomPan(); // mulai fit
        };
        img.src = el.getAttribute('src') || '';
        lb.classList.add('open');
      }
      function hide(){
        lb.classList.remove('open');
        img.src = '';
      }

      // buka dari gambar kecil (class="zoomable")
      document.addEventListener('click', function(e){
        var t = e.target;
        if (t && t.classList && t.classList.contains('zoomable')) openFromEl(t);
      });

      // tutup
      lb.addEventListener('click', function(e){ if(e.target === lb) hide(); });
      btnClose.addEventListener('click', hide);
      document.addEventListener('keydown', function(e){ if(e.key === 'Escape') hide(); });

      // WHEEL ZOOM
      function onWheel(e){
        e.preventDefault();
        var dir = (e.deltaY < 0) ? 1 : -1;         // up=in
        var next = Math.min(MAX_Z, Math.max(MIN_Z, scale + dir*STEP));
        if (next !== scale){
          scale = next;
          clampPan();
          applyTransform();
        }
      }
      inner.addEventListener('wheel', onWheel, {passive:false});
      img.addEventListener('wheel',   onWheel, {passive:false});

      // DRAG PAN (mouse + touch) — hanya saat zoom > 1
      function canPan(){ return scale > 1; }
      function onDown(x,y){
        if (!canPan()) return;
        dragging = true;
        startX = x; startY = y; startTx = tx; startTy = ty;
        document.body.style.userSelect = 'none';
        applyTransform();
      }
      function onMove(x,y){
        if (!dragging) return;
        tx = startTx + (x - startX);
        ty = startTy + (y - startY);
        clampPan();
        applyTransform();
      }
      function onUp(){
        if (!dragging) return;
        dragging = false;
        document.body.style.userSelect = '';
        applyTransform();
      }

      // mouse
      inner.addEventListener('mousedown', function(e){ onDown(e.clientX, e.clientY); });
      document.addEventListener('mousemove', function(e){ onMove(e.clientX, e.clientY); });
      document.addEventListener('mouseup', onUp);

      // touch
      inner.addEventListener('touchstart', function(e){
        if (e.touches.length !== 1) return;
        var t = e.touches[0]; onDown(t.clientX, t.clientY);
      }, {passive:true});
      inner.addEventListener('touchmove', function(e){
        if (!dragging || e.touches.length !== 1) return;
        var t = e.touches[0]; onMove(t.clientX, t.clientY);
      }, {passive:true});
      inner.addEventListener('touchend', onUp);
      inner.addEventListener('touchcancel', onUp);

      // resize → fit ulang & clamp pan
      addEventListener('resize', function(){
        if(!lb.classList.contains('open')) return;
        computeBaseScale(); clampPan(); applyTransform();
      });
    })();
  </script>
</body>
</html>
